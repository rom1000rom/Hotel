<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
	xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

	<changeSet id="1" author="Survordie">
		<createTable tableName="hotel">
			<column name="id" type="int8">
				<constraints primaryKeyName="hotel_pkey"
					primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="int" />
			<column name="hotel_name" type="varchar(255)">
				<constraints nullable="false" />
			</column>

		</createTable>
	</changeSet>

	<changeSet id="2" author="Survordie">
		<createTable tableName="person">
			<column name="id" type="int8">
				<constraints primaryKeyName="person_pkey"
					primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="int" />
			<column name="person_name" type="varchar(255)" />
			<column name="encryted_password" type="varchar(255)" />
			<column name="blacklisted" type="boolean"
				defaultValueBoolean="false" />
			<column name="admin" type="boolean"
				defaultValueBoolean="false" />
		</createTable>
	</changeSet>

	<changeSet id="3" author="Survordie">
		<createTable tableName="facilities">
			<column name="id" type="int8">
				<constraints primaryKeyName="facilities_pkey"
					primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="int" />
			<column name="facilities_name" type="varchar(255)" />
			<column name="facilities_number" type="varchar(255)">
				<constraints nullable="false" />
			</column>
			<column name="facilities_price" type="float" />
			<column name="hotel_id" type="int8" />
		</createTable>
	</changeSet>

	<changeSet id="4" author="Survordie">
		<createTable tableName="room">
			<column name="id" type="int8">
				<constraints primaryKeyName="room_pkey"
					primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="int" />
			<column name="room_number" type="varchar(255)">
				<constraints nullable="false" />
			</column>
			<column name="hotel_id" type="int8" />
		</createTable>
	</changeSet>

	<changeSet id="5" author="Survordie">
		<createTable tableName="invoice">
			<column name="id" type="int8">
				<constraints primaryKeyName="invoice_pkey"
					primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="int" />
			<column name="invoice_number" type="varchar(255)" />
			<column name="date_begin" type="date">
				<constraints nullable="false" />
			</column>
			<column name="date_end" type="date">
				<constraints nullable="false" />
			</column>
			<column name="person_id" type="int8" />
		</createTable>
	</changeSet>

	<changeSet id="6" author="Survordie">
		<createTable tableName="provided_facilities">
			<column name="id" type="int8">
				<constraints primaryKeyName="provided_facilities_pkey"
					primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="int" />
			<column name="date_facilities" type="date" />
			<column name="cost_facilities" type="float" />
			<column name="count_facilities" type="int8" />
			<column name="facilities_id" type="int8" />
			<column name="invoice_id" type="int8" />
		</createTable>
	</changeSet>

	<changeSet id="7" author="Survordie">
		<createTable tableName="provided_room">
			<column name="id" type="int8">
				<constraints primaryKeyName="provided_room_pkey"
					primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="int" />
			<column name="date_room" type="date" />
			<column name="cost_room" type="float" />
			<column name="room_id" type="int8" />
			<column name="invoice_id" type="int8" />
		</createTable>
	</changeSet>

	<changeSet id="8" author="Survordie">
		<createTable tableName="reservation">
			<column name="id" type="int8">
				<constraints primaryKeyName="reservation_pkey"
					primaryKey="true" nullable="false" />
			</column>
			<column name="version" type="int" />
			<column name="date_begin" type="date">
				<constraints nullable="false" />
			</column>
			<column name="date_end" type="date">
				<constraints nullable="false" />
			</column>
			<column name="person_id" type="int8" />
			<column name="room_id" type="int8" />
		</createTable>
	</changeSet>

	<changeSet id="100" author="Survordie">
		<addForeignKeyConstraint
			constraintName="fk_hotel_facilities" baseColumnNames="hotel_id"
			baseTableName="facilities" referencedColumnNames="id"
			referencedTableName="hotel" />

		<addForeignKeyConstraint
			constraintName="fk_hotel_room" baseColumnNames="hotel_id"
			baseTableName="room" referencedColumnNames="id"
			referencedTableName="hotel" />

		<addForeignKeyConstraint
			constraintName="fk_invoice_person_id" baseColumnNames="person_id"
			baseTableName="invoice" referencedColumnNames="id"
			referencedTableName="person" />

		<addForeignKeyConstraint
			constraintName="fk_provided_facilities_id"
			baseColumnNames="facilities_id" baseTableName="provided_facilities"
			referencedColumnNames="id" referencedTableName="facilities" />

		<addForeignKeyConstraint
			constraintName="fk_invoice_provided_facilities_id"
			baseColumnNames="invoice_id" baseTableName="provided_facilities"
			referencedColumnNames="id" referencedTableName="invoice" />

		<addForeignKeyConstraint
			constraintName="fk_provided_room_id" baseColumnNames="room_id"
			baseTableName="provided_room" referencedColumnNames="id"
			referencedTableName="room" />

		<addForeignKeyConstraint
			constraintName="fk_invoice_provided_room_id"
			baseColumnNames="invoice_id" baseTableName="provided_room"
			referencedColumnNames="id" referencedTableName="invoice" />

		<addForeignKeyConstraint
			constraintName="fk_reservation_person_id" baseColumnNames="person_id"
			baseTableName="reservation" referencedColumnNames="id"
			referencedTableName="person" />

		<addForeignKeyConstraint
			constraintName="fk_reservation_room_id" baseColumnNames="room_id"
			baseTableName="reservation" referencedColumnNames="id"
			referencedTableName="room" />

	</changeSet>

</databaseChangeLog>